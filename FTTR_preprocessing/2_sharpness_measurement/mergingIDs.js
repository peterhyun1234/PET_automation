const xlsx = require( "xlsx" );
const fs = require('fs');

const studyTerm = "201912_202007";
const excelFile = xlsx.readFile( "../1_data_mining/result/" + studyTerm + "/" + studyTerm + "_mined_data.xlsx" );
let sheetIdx = 0;
let degreeOfMachines = 4;

while(sheetIdx < degreeOfMachines){
    
    const sheetName = excelFile.SheetNames[sheetIdx]; 
    const currSheet = excelFile.Sheets[sheetName]; 

    console.log( "Reading sheet 1: " +  sheetName);
    const jsonData = xlsx.utils.sheet_to_json( currSheet, { defval : ""} );
    
    let data_len = jsonData.length;
    let outputString = "";
    
    for(let i = 0; i < data_len; i++){
        if(i === data_len-1){
            outputString += jsonData[i].ID;
        }else{
            outputString += jsonData[i].ID + ", ";
        }
    }
    console.log(outputString);
    //console.log(data_len);
    //fs.writeFileSync("merged_IDs.txt", '\ufeff' + outputString, {encoding: 'utf8'});
    
    sheetIdx++; // next sheet
}

// 2615226, 2611764, 2608628, 1557555, 2611028, 2609423, 2608937, 1532302, 2602958, 2601179, 2601971, 2596663, 2592403, 2593405, 2587058, 2587598, 2581492, 2585692, 2571237, 7079022, 2515449, 2567087, 2579105, 2577384, 2376239, 2577265, 2576017, 2572679, 2573651, 2569090, 2568971, 2559744, 2557471, 2553543, 2554683, 2550261, 1051395, 2220466, 2070121, 2288499, 2396217, 1865747, 2309691, 2409703, 7215522, 2427704, 2604097, 2105703, 2606959, 0240983, 1611302, 2474997, 2524295, 2376012, 1252407, 2559710, 2511600, 0300475, 2588488, 2156722, 2576322, 2208516, 2598726, 2305227, 2006401, 2283595, 2188763, 1433444, 0178265, 2574240, 2412132, 2556549, 2377129, 1336839, 2272422, 2438745, 2497085, 2310985, 2249528, 2447303, 2372783, 2017328, 2594547, 2249700, 7051378, 1220089, 2615746, 2613529, 2610292, 2615734, 2613609, 0560020, 2611725, 2295380, 2606350, 2603684, 0651274, 2601829, 1832384, 2599189, 0513637, 0007208, 2596775, 2591195, 2394145, 2590297, 2376060, 2575799, 2586041, 7144994, 2585591, 2581089, 2581656, 0040293, 1872233, 2577900, 0025070, 0747518, 2469489, 2569939, 2560626, 2564686, 2555814, 2557093, 0577805, 0625596, 0306597, 2268579, 2166857, 2439017, 2123046, 1941538, 2156509, 2139565, 0670200, 2572519, 1455084, 0907238, 2032164, 2211119, 2430125, 0415638, 2451840, 0632847, 2288429, 1941966, 2168823, 2034237, 2139565, 2342489, 2341179, 2409862, 0165466, 2432595, 0002458, 0313649, 2508426, 2498170, 0294214, 1846116, 2127992, 1999000, 7239501, 0107922, 0106154, 1735747, 2062405, 0478561, 2464010, 1098806, 0730934, 2563168, 1228824, 1696447, 2194940, 2597001, 0871792, 0067276, 7036951, 2468767, 2568686, 2065295, 2600375, 2562798, 2604426, 2613107, 2215886, 0248221, 2608910, 2590092, 2567627, 2510429, 2575010, 2097304, 1915691, 2597445, 2050478, 2592957, 0086757, 2586087, 2616525, 2553132, 2566214, 2578652, 2215886, 1588272, 2580026, 2599930, 2581120, 2570861, 1964954, 2617637, 2600949, 0743187, 2564893, 2567000, 0242935, 2559524, 2559107, 0970387, 0474196, 2529806, 7047411, 0689582, 0955848, 1401081, 1596093, 2129853, 1712059, 0872886, 2465611, 2426065, 0382314, 1714240, 2494917, 1759894, 1840747, 2180331, 2056603, 1222533, 0424423, 2594699, 1433097, 0556307, 0146165, 7021319, 2245889, 0895837, 0040184, 2309621, 0753269, 1267354, 2004797, 0093470, 1226182, 1680679, 1411951, 2077713, 1665580, 1260594, 2335533, 7057918, 7183727, 1848570, 1332752, 2548665, 7106084, 7273249, 1658743, 2305471, 2139318, 0826512, 2201116, 0037396, 2493467, 1957559, 0471578, 2353729, 2105984, 2574406, 2600422, 2423461, 0293909, 1383115, 2281173, 1264949, 2441340, 2204592, 2600627, 2586355, 1792054, 0392821, 0647331, 1720386, 0805630, 2254890, 2298628, 2268569, 2619814, 0524487, 0405802, 0234487, 2557536, 2551734, 2595198, 2605965, 2580065, 1894392, 1007811, 2409438, 1335710, 0255372, 2460566, 2577426, 2603456, 7174583, 2552256, 0071407, 1346574, 0943510, 2482026, 2586414, 2607196, 2596581, 0064868, 0104290, 2525810, 0368815, 0436734, 1045766, 2298462, 0646871, 0458599, 2543665, 0126838, 2065682, 2611460, 0095757, 0623408, 1147647, 1159395, 1213572, 0006586, 1971703, 1162351, 2564279, 2559363, 0006380, 0595821, 2504934, 2291644, 1332072, 2166127, 2561830, 0213218, 2576767, 2459027, 0939195, 7215836, 0475592, 0068886, 2077121, 0395863, 0325232, 2246375, 2132211, 2322924, 1108444, 2262995, 1383773, 2616980, 2047610, 1500974, 1093912, 2026277, 0809550, 1959556, 1660111, 2070956, 2425216, 0907747, 1620689, 1633785, 1246659, 1981786, 2206196, 0408224, 7259071, 7154499, 1276349, 2542544, 0842359, 0279503, 1545159, 2605067, 2425371, 1399650, 0781717, 2387374, 2537860, 0177097, 2554870, 0124107, 0371145, 1378662, 0291843, 2572726, 0291843, 1545159, 0383353, 0004702, 2176805, 1115376, 0527999, 2522393, 0021639, 0202986, 1257907, 2220631, 0268434, 1087629, 2317760, 1931238, 2407327, 0616667, 2615448, 0640939, 0940593, 1995798, 1973113, 2427318, 2593133, 2382482, 1412902, 1297510, 0488149, 0513999, 0580508, 0015410, 0891522, 0289150, 1225223, 0499437, 0388532, 0526757, 2109254, 2485835, 0188490, 1760278, 0661639, 0964715, 0580929, 2452912, 2607724, 1378135, 2571280, 2129075, 1685253, 2407912, 0772869, 1643377, 2617517, 1877894, 2303278, 0206070, 2444386, 1632711, 2580911, 1088618, 2422379, 0558656, 1978685, 0513999, 1751270, 0677838

// 2612953, 2612853, 2613517, 2602398, 7150424, 2592088, 2582889, 2582888, 2455582, 2572101, 2568724, 2562416, 2560024, 2581799, 0488387, 2134730, 2239035, 2342380, 0994313, 2544654, 1369625, 2303354, 0486352, 1872837, 2469765, 2417938, 2601270, 7288909, 2307058, 2480078, 7140766, 2585861, 0006971, 2517643, 2537872, 1880934, 1768598, 2323397, 2618537, 2617354, 2617836, 2614700, 2610620, 2606752, 1514241, 7300939, 2601412, 2595690, 2406522, 2597851, 2592984, 2592973, 2592258, 2589443, 2502682, 2582894, 2461079, 2572032, 2572412, 2568432, 1186384, 2552142, 2556293, 2377797, 7054263, 0933831, 2024822, 1709690, 0860320, 0639202, 2561261, 7198691, 1981231, 0155134, 7133299, 2206491, 0126206, 1796797, 0249024, 1051932, 0883107, 0937749, 0208911, 1934475, 2566755, 2562670, 2539794, 0403958, 1060851, 1654805, 2193854, 1297583, 0159774, 1910340, 1934640, 1056958, 0798517, 7032449, 2237470, 2520236, 0629644, 2249903, 1953140, 0474162, 0541082, 1783967, 2188902, 2576373, 0308240, 2006019, 2077006, 0891619, 1186339, 2619056, 0558248, 0191192, 2615731, 2615620, 2612768, 2610432, 2610067, 2608254, 2599665, 1821667, 2600598, 2603922, 2600350, 2598157, 1579748, 1845434, 2307699, 1044188, 2592969, 7276946, 0502558, 2589767, 2589786, 2586092, 2585429, 2578070, 2581595, 1461959, 2584487, 0993635, 2460155, 0237716, 1192608, 2575079, 2569386, 2569695, 2552122, 1315552, 2542354, 1333112, 0314921, 2313120, 1654799, 2557579, 0754720, 1416316, 0660996, 1247375, 2537617, 2205978, 2603541, 0918811, 0479825, 1192197, 0210492, 0891619, 1149842, 1283728, 2014724, 2422357, 1922008, 1194558, 1409647, 2196475, 0286769, 0261747, 2573546, 7065119, 0184080, 2553742, 2258240, 1249659, 7219113, 0454008, 0271446, 2361543, 0588098, 0844101, 1476564, 2449241, 0504196, 0739145, 7231661, 0273206, 2596644, 1678371, 1991067, 2292483, 7142698, 2617511, 0135783, 7209349, 2616214, 1623217, 2612704, 1998993, 2603498, 1786191, 2396763, 2281382, 2608567, 0546732, 2456937, 1251726, 2215443, 2337318, 2045275, 2596586, 2596155, 2477157, 2344711, 2595579, 0842283, 2586197, 7041198, 7098399, 1968995, 0247964, 2583063, 1367508, 2574209, 0149215, 2577806, 2299995, 0753195, 0239247, 2575964, 0255090, 2573318, 2552002, 1404724, 0647331, 2550078, 0035917, 2187913, 1660868, 0460800, 1832253, 2419929, 1488368, 2248721, 2330512, 2444166, 2200743, 1123386, 0747292, 0084322, 2312558, 0827550, 2356682, 2419513, 1969860, 2389857, 7172039, 1133514, 1198080, 1283371, 1149796, 1970513, 0002486, 2056440, 2361964, 2601716, 0951069, 2317805, 1769176, 2310548, 1148088, 2499540, 2238768, 0020729, 1116997, 0027545, 2366157, 0341148, 0782296, 0057456, 0104290, 0289667, 1793073, 1181682, 2495387, 0298731, 2611215, 0481979, 1845017, 0363174, 1679478, 2614371, 1751290, 1349105, 2531486, 2077367, 2181701, 2488332, 2513205, 1949002, 2219619, 2133391, 0819629, 0483895, 1392490, 7025520, 1153104, 0297213, 7284816, 2580178, 1114816, 0745157, 0658318, 0274627, 1236880, 2487462, 2565303, 2423661, 0576732, 2544994, 2416864, 1155567, 0790824, 7233626, 2047279, 2016456, 0027333, 2612339, 1374648, 0099583, 0919352, 2601968, 2379188, 2602343, 2485445, 0753941, 2469490, 1232032, 1196309, 2269199, 2525020, 2502909, 0210336, 0047292, 2179245, 2569518, 0211871, 0599390, 1969347, 1390392, 2130396, 2262502, 7277693, 2016456, 1090612, 0082428, 2437088, 2565676, 1203550, 7180675, 0583592, 2382482, 2553974
